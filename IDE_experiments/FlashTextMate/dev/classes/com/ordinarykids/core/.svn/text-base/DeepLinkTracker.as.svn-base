/** *	CLASS : DeepLinkTracking *  VERSION : 1.10  *  UPDATED : 3/21/2009 *  ACTIONSCRIPT VERSION : 3.0  *  AUTHOR : Stephen Braitsch : stephen@ordinarykids.com**/package com.ordinarykids.core {		import com.asual.swfaddress.*;	import flash.events.Event;			import flash.display.Sprite;	import flash.text.TextField;	import flash.text.TextFieldAutoSize;			public class DeepLinkTracker extends Sprite 	{					private static var _home		:String;		// default site name to display in title bar //		private static var _path		:String;		// address bar value //		private static var _output		:TextField;		private static var _debug		:Boolean = false;						public function DeepLinkTracker()		{			_home = SWFAddress.getTitle();		    SWFAddress.addEventListener(SWFAddressEvent.CHANGE, handleSWFAddressChange);		}		 //- PUBLIC SETTERS ----------------------------------------------------------------------					public function set path($a:Array):void		{			var str:String = $a.join('/');				_path = formatToURL(str);		// format address and title bar //				SWFAddress.setValue(_path);					//	SWFAddress.setTitle(_home+' • '+toTitleCase(str));			}					public function get path():Array		{			return SWFAddress.getValue().substr(1).split('/');		}		 			public function set debug($b:Boolean):void 		{			_debug = $b; drawOutputPanel();		}		 //- SWF ADDRESS ----------------------------------------------------------------------					// this is always called immediately when the page loads // 	        private function handleSWFAddressChange(e:SWFAddressEvent):void        {			if (_debug) log(path.join('/'));		// tell main app the address bar has changed //			if (SWFAddress.getValue().substr(1) != _path) dispatchEvent(new Event(Event.CHANGE));						        } //- CONVERSION UTILITIES ----------------------------------------------------------------------		private function toTitleCase($str:String):String		{			return $str.split('/').map(toUpperCase).join(' • ');		}				private function toUpperCase($str:String, i:int, a:Array):String		{ 			return $str.substr(0, 1).toUpperCase() + $str.substr(1);		}				private function formatToURL($s:String):String		{		// match ' / ', '/', and ' '  				var p:RegExp = / \/ |\/ | /g;			return $s.toLowerCase().replace(p, '-');		}		 //- OUTPUT PANEL ----------------------------------------------------------------------						public function write($i:*):void		{			_output.appendText($i+'\n');		}				private function drawOutputPanel():void		{			graphics.beginFill(0x333333);			graphics.drawRect(0, 0, 250, 1000);			graphics.endFill();			_output = new TextField();			_output.width = 250;			_output.textColor = 0xFFFFFF;			_output.x = _output.y = 25; addChild(_output);			_output.autoSize = TextFieldAutoSize.LEFT;		}				private function log($v:String):void		{			_output.appendText('deeplinking to : '+ $v + '\n');					}			}	}